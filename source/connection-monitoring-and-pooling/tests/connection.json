{
  "version": 1,
  "style": "unit",
  "tests": [
    {
      "description": "must have an ID number associated with it.",
      "operations": [
        {
          "name": "createPool",
          "returnTo": "pool"
        },
        {
          "name": "acquire",
          "object": "pool",
          "returnTo": "conn1"
        },
        {
          "name": "acquire",
          "object": "pool",
          "returnTo": "conn2"
        }
      ],
      "events": [
        {
          "type": "connectionPoolQueueEntered"
        },
        {
          "type": "connectionCreated",
          "connection": {
            "id": {
              "$$ref": [
                "conn1",
                "id"
              ]
            }
          }
        },
        {
          "type": "connectionPoolAcquire",
          "connection": {
            "id": {
              "$$ref": [
                "conn1",
                "id"
              ]
            }
          }
        },
        {
          "type": "connectionPoolQueueEntered"
        },
        {
          "type": "connectionCreated",
          "connection": {
            "id": {
              "$$ref": [
                "conn2",
                "id"
              ]
            }
          }
        },
        {
          "type": "connectionPoolAcquire",
          "connection": {
            "id": {
              "$$ref": [
                "conn2",
                "id"
              ]
            }
          }
        }
      ],
      "ignore": [
        "connectionPoolCreated",
        "connectionPoolDestroyed"
      ]
    },
    {
      "description": "must have IDs assigned in order of creation.",
      "operations": [
        {
          "name": "createPool",
          "returnTo": "pool"
        },
        {
          "name": "acquire",
          "object": "pool",
          "returnTo": "conn1"
        },
        {
          "name": "acquire",
          "object": "pool",
          "returnTo": "conn2"
        }
      ],
      "events": [
        {
          "type": "connectionPoolQueueEntered"
        },
        {
          "type": "connectionCreated",
          "connection": {
            "id": 0
          }
        },
        {
          "type": "connectionPoolAcquire",
          "connection": {
            "id": 0
          }
        },
        {
          "type": "connectionPoolQueueEntered"
        },
        {
          "type": "connectionCreated",
          "connection": {
            "id": 1
          }
        },
        {
          "type": "connectionPoolAcquire",
          "connection": {
            "id": 1
          }
        }
      ],
      "ignore": [
        "connectionPoolCreated",
        "connectionPoolDestroyed"
      ]
    },
    {
      "description": "must have a generation number that reflects pool generation when connection was created",
      "operations": [
        {
          "name": "createPool",
          "returnTo": "pool"
        },
        {
          "name": "clear",
          "object": "pool"
        },
        {
          "name": "clear",
          "object": "pool"
        },
        {
          "name": "acquire",
          "object": "pool",
          "returnTo": "conn"
        },
        {
          "name": "clear",
          "object": "pool"
        },
        {
          "name": "release",
          "object": "pool",
          "args": [
            {
              "$$ref": [
                "conn"
              ]
            }
          ]
        }
      ],
      "events": [
        {
          "type": "connectionPoolCleared",
          "pool": {
            "generation": 1
          }
        },
        {
          "type": "connectionPoolCleared",
          "pool": {
            "generation": 2
          }
        },
        {
          "type": "connectionCreated",
          "connection": {
            "id": 0,
            "generation": 2
          },
          "pool": {
            "generation": 2
          }
        },
        {
          "type": "connectionPoolAcquire",
          "connection": {
            "id": 0,
            "generation": 2
          },
          "pool": {
            "generation": 2
          }
        },
        {
          "type": "connectionPoolCleared",
          "pool": {
            "generation": 3
          }
        },
        {
          "type": "connectionPoolRelease",
          "connection": {
            "id": 0,
            "generation": 2
          },
          "pool": {
            "generation": 3
          }
        }
      ],
      "ignore": [
        "connectionPoolQueueEntered",
        "connectionPoolCreated",
        "connectionPoolDestroyed"
      ]
    }
  ]
}
