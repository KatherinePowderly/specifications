version: 1
style: unit
description: must have a generation number that reflects pool generation when connection was created
operations:
  # Clears the pool twice to ensure that generation is 2
  - name: clear
  - name: clear
  # Acquire a connection
  - name: acquire
    label: conn
  # Clear the pool, increasing that generation to 3
  - name: clear
  # Release connection, generation should still be 2
  - name: release
    connection: conn
events:
  - type: connectionPoolCleared
    pool:
      generation: 1
  - type: connectionPoolCleared
    pool:
      generation: 2
  - type: connectionCreated
    connection:
      id: 1
      generation: 2
    pool:
      generation: 2
  - type: connectionAcquired
    connection:
      id: 1
      generation: 2
    pool:
      generation: 2
  - type: connectionPoolCleared
    pool:
      generation: 3
  - type: connectionReleased
    connection:
      id: 1
      generation: 2
    pool:
      generation: 3
ignore:
  - connectionAcquisitionStarted
  - connectionPoolCreated
  - connectionPoolDestroyed